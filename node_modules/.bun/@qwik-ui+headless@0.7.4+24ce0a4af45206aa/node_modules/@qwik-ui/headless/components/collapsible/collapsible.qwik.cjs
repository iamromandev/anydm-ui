"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const jsxRuntime = require("@builder.io/qwik/jsx-runtime");
const qwik = require("@builder.io/qwik");
const collapsibleContext = require("./collapsible-context.qwik.cjs");
const build = require("@builder.io/qwik/build");
const useCollapsible = require("./use-collapsible.qwik.cjs");
const HCollapsible = qwik.component$((props) => {
  const { disabled, onOpenChange$, onChange$, "bind:open": givenIsOpenSig, id, triggerRef: givenTriggerRef, collapsible = true, open, accordionItem, ...rest } = props;
  const defaultOpenSig = qwik.useSignal(open ?? false);
  const isOpenSig = givenIsOpenSig ?? defaultOpenSig;
  const defaultTriggerRef = qwik.useSignal();
  const triggerRef = givenTriggerRef ?? defaultTriggerRef;
  const contentRef = qwik.useSignal();
  const contentHeightSig = qwik.useSignal(null);
  const { getHiddenHeight } = useCollapsible.useCollapsible();
  const localId = qwik.useId();
  const itemId = id ?? localId;
  qwik.useTask$(function onOpenChangeTask({ track }) {
    track(() => isOpenSig.value);
    if (build.isBrowser) {
      onOpenChange$?.(isOpenSig.value);
      onChange$?.(isOpenSig.value);
    }
  });
  const getContentDimensions$ = qwik.$(async () => {
    if (!contentRef.value) {
      throw new Error("Qwik UI: There is no reference to the collapsible content element. Make sure to wrap the content in a <CollapsibleContent> component.");
    }
    if (contentHeightSig.value === null) {
      contentHeightSig.value = await getHiddenHeight(contentRef.value);
    }
    if (contentHeightSig.value !== 0) {
      contentRef.value.style.setProperty("--qwikui-collapsible-content-height", `${contentHeightSig.value}px`);
      if (accordionItem) {
        contentRef.value.style.setProperty("--qwikui-accordion-content-height", `${contentHeightSig.value}px`);
      }
    }
  });
  const context = {
    isOpenSig,
    itemId,
    triggerRef,
    contentRef,
    contentHeightSig,
    getContentDimensions$,
    disabled,
    collapsible
  };
  qwik.useContextProvider(collapsibleContext.collapsibleContextId, context);
  return /* @__PURE__ */ jsxRuntime.jsx("div", {
    id: itemId,
    "data-collapsible": true,
    "data-disabled": context.disabled ? "" : void 0,
    "data-open": context.isOpenSig.value ? "" : void 0,
    "data-closed": !context.isOpenSig.value ? "" : void 0,
    "aria-live": "polite",
    ...rest,
    children: /* @__PURE__ */ jsxRuntime.jsx(qwik.Slot, {})
  });
});
exports.HCollapsible = HCollapsible;

"use strict";
Object.defineProperty(exports, Symbol.toStringTag, { value: "Module" });
const jsxRuntime = require("@builder.io/qwik/jsx-runtime");
const qwik = require("@builder.io/qwik");
const progressContext = require("./progress-context.qwik.cjs");
const boundSignal = require("../../utils/bound-signal.qwik.cjs");
const ProgressRoot = qwik.component$((props) => {
  const { "bind:value": givenValueSig, ...rest } = props;
  const defaultMax = 100;
  const minSig = qwik.useComputed$(() => props.min ?? 0);
  const maxSig = qwik.useComputed$(() => props.max ?? defaultMax);
  const valueSig = boundSignal.useBoundSignal(givenValueSig, props.value ?? null);
  qwik.useTask$(({ track }) => {
    if (props.value === void 0) return;
    track(() => props.value);
    valueSig.value = props.value;
  });
  const isValidProgressSig = qwik.useComputed$(() => {
    const isMaxFinite = Number.isFinite(maxSig.value);
    const isMaxGreaterThanMin = maxSig.value > minSig.value;
    const isValueValid = valueSig.value === null || valueSig.value >= minSig.value;
    return isMaxFinite && isMaxGreaterThanMin && isValueValid;
  });
  const valueLabelSig = qwik.useComputed$(() => {
    const value = valueSig.value ?? minSig.value;
    const range = maxSig.value - minSig.value;
    if (props.getValueLabel) {
      return props.getValueLabel(value, maxSig.value);
    }
    return `${Math.round((value - minSig.value) / range * 100)}%`;
  });
  qwik.useTask$(function checkValidProgress({ track }) {
    track(() => isValidProgressSig.value);
    if (!isValidProgressSig.value) {
      throw new Error("Qwik UI: Progress component must be a finite number, and within the max and min range.");
    }
  });
  const progressSig = qwik.useComputed$(() => {
    if (valueSig.value == null) return "indeterminate";
    const range = maxSig.value - minSig.value;
    const progress = (valueSig.value - minSig.value) / range;
    return progress >= 1 ? "complete" : "loading";
  });
  const dataAttributesSig = qwik.useComputed$(() => {
    return {
      "data-progress": progressSig.value,
      "data-value": valueSig.value ?? void 0,
      "data-max": maxSig.value,
      "data-min": minSig.value
    };
  });
  const context = {
    dataAttributesSig,
    valueSig,
    maxSig,
    minSig
  };
  qwik.useContextProvider(progressContext.ProgressContext, context);
  return /* @__PURE__ */ jsxRuntime.jsx("div", {
    role: "progressbar",
    "aria-label": "progress",
    "aria-valuemax": maxSig.value,
    "aria-valuemin": minSig.value,
    "aria-valuenow": valueSig.value ?? void 0,
    "aria-valuetext": valueLabelSig.value,
    ...dataAttributesSig.value,
    ...rest,
    children: /* @__PURE__ */ jsxRuntime.jsx(qwik.Slot, {})
  });
});
exports.ProgressRoot = ProgressRoot;

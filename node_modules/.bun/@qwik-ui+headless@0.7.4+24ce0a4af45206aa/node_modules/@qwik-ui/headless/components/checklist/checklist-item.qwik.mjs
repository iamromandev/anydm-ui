import { jsx } from "@builder.io/qwik/jsx-runtime";
import { component$, useContext, useSignal, useTask$, Slot } from "@builder.io/qwik";
import { CheckboxRoot } from "../checkbox/checkbox-root.qwik.mjs";
import { ChecklistContext } from "./checklist-context.qwik.mjs";
const ChecklistItem = component$((props) => {
  const { _index } = props;
  if (_index === void 0) {
    throw new Error("Checklist Item must have an index.");
  }
  const context = useContext(ChecklistContext);
  const isCheckedSig = useSignal(context.items.value[_index]);
  const initialLoadSig = useSignal(true);
  useTask$(({ track }) => {
    track(() => context.allSelected.value);
    if (initialLoadSig.value) {
      return;
    }
    if (context.allSelected.value) {
      isCheckedSig.value = true;
    } else {
      isCheckedSig.value = false;
    }
  });
  useTask$(function syncCheckboxState({ track }) {
    track(() => isCheckedSig.value);
    context.items.value[_index] = isCheckedSig.value;
    const isAllSelected = context.items.value.every((item) => item === true);
    if (isAllSelected) {
      context.allSelected.value = true;
    }
  });
  useTask$(() => {
    initialLoadSig.value = false;
  });
  return /* @__PURE__ */ jsx(CheckboxRoot, {
    as: "li",
    "bind:checked": isCheckedSig,
    index: _index,
    children: /* @__PURE__ */ jsx(Slot, {})
  });
});
export {
  ChecklistItem
};

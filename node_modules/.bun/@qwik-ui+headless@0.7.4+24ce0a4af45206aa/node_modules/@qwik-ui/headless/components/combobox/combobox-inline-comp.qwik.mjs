import { jsx } from "@builder.io/qwik/jsx-runtime";
import { HComboboxRootImpl } from "./combobox-root.qwik.mjs";
import { HComboboxItem } from "./combobox-item.qwik.mjs";
import { HComboboxItemLabel } from "./combobox-item-label.qwik.mjs";
import { HComboboxEmpty } from "./combobox-empty.qwik.mjs";
import { HComboboxErrorMessage } from "./combobox-error-message.qwik.mjs";
import { findComponent, processChildren } from "../../utils/inline-component.qwik.mjs";
const HComboboxRoot = (props) => {
  const { children, comboboxItemComponent: UserItem, comboboxItemLabelComponent: UserItemLabel, ...rest } = props;
  const HComboboxItem$1 = UserItem ?? HComboboxItem;
  const HComboboxItemLabel$1 = UserItemLabel ?? HComboboxItemLabel;
  const HComboboxEmpty$1 = HComboboxEmpty;
  const itemsMap = /* @__PURE__ */ new Map();
  let currItemIndex = 0;
  let initialIndex = null;
  let initialValue;
  let isItemDisabled = false;
  let givenItemValue = null;
  let hasEmptyComp = false;
  let hasErrorComp = false;
  findComponent(HComboboxItem$1, (itemProps) => {
    itemProps._index = currItemIndex;
    isItemDisabled = itemProps.disabled === true;
    if (itemProps.value) {
      givenItemValue = itemProps.value;
    }
    if (itemProps.children) {
      return processChildren(itemProps.children);
    }
  });
  findComponent(HComboboxItemLabel$1, (labelProps) => {
    const displayValue = labelProps.children;
    const value = givenItemValue !== null ? givenItemValue : displayValue;
    itemsMap.set(currItemIndex, {
      value,
      displayValue,
      disabled: isItemDisabled
    });
    if (props.value && props.multiple) {
      throw new Error(`Qwik UI: When in multiple selection mode, the value prop is disabled. Use the bind:value prop's initial signal value instead.`);
    }
    if (value === props.value) {
      initialIndex = currItemIndex;
      initialValue = value;
    }
    currItemIndex++;
  });
  findComponent(HComboboxEmpty$1, () => {
    hasEmptyComp = true;
  });
  findComponent(HComboboxErrorMessage, () => {
    hasErrorComp = true;
  });
  processChildren(children);
  return /* @__PURE__ */ jsx(HComboboxRootImpl, {
    ...rest,
    initialIndex,
    initialValue,
    _itemsMap: itemsMap,
    hasEmptyComp,
    hasErrorComp,
    children
  });
};
export {
  HComboboxRoot
};
